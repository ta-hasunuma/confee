# 要件定義書

## はじめに
confeeは、Compass APIを活用して技術カンファレンス情報を取得し、ユーザの自然言語クエリに基づいてカンファレンスを提示するエージェントである。ユーザは「仕様駆動に関するカンファレンスってある？」「面白そうなカンファレンス見つけてきて」といった質問を投げかけることで、おすすめ度・期限・申込リンク等の有用な情報を分かりやすく受け取ることができる。ログイン機能は不要とし、MVPとしてAWS環境で動作するものを構築する。

## 要件

### 要件1: 自然言語クエリによるカンファレンス検索
**ユーザストーリー:** エンジニアとして、自然言語で技術カンファレンスについて質問したい。それによって、目的に合ったカンファレンス情報を素早く得られる。

#### 受入基準
1. WHEN ユーザが具体的なキーワードを含むクエリを送信した場合（例：「typescriptのLT会ある？」）THEN システム SHALL 該当キーワードに関連するカンファレンスをCompass APIから検索し、結果を提示する
2. WHEN ユーザが技術トピックに関するクエリを送信した場合（例：「仕様駆動に関するカンファレンスってある？」）THEN システム SHALL トピックに関連するカンファレンスを検索し、マッチするものを提示する
3. WHEN ユーザのクエリに対してCompass APIの検索結果が0件の場合 THEN システム SHALL 結果が見つからなかった旨をユーザに通知し、クエリの変更を提案する
4. WHEN ユーザが日本語でクエリを送信した場合 THEN システム SHALL 日本語で応答する

### 要件2: あいまいなクエリに対するインテリジェントな推薦
**ユーザストーリー:** エンジニアとして、「面白そうなカンファレンス見つけてきて」のようなあいまいな要望を出したい。それによって、自分では見つけられなかった興味深いカンファレンスを発見できる。

#### 受入基準
1. WHEN ユーザが「面白そうな」「おすすめの」「人気のある」等のあいまいなクエリを送信した場合 THEN システム SHALL エージェントが思考・推論した上で、複数のカンファレンスを推薦理由とともに提示する
2. WHEN あいまいなクエリに対して推薦を行う場合 THEN システム SHALL 各カンファレンスに対しておすすめ度（高・中・低 またはスコア）を付与して提示する
3. WHEN あいまいなクエリを処理する場合 THEN システム SHALL 推薦の根拠（例：注目度が高い、ユニークなテーマ、参加者数が多い等）を明示する

### 要件3: Compass APIとの連携
**ユーザストーリー:** システムとして、Compass APIから最新の技術カンファレンス情報を取得したい。それによって、ユーザに正確で最新の情報を提供できる。

#### 受入基準
1. WHEN ユーザからクエリを受信した場合 THEN システム SHALL Compass APIを呼び出してカンファレンス情報を取得する
2. IF Compass APIからのレスポンスにエラーが含まれる場合 THEN システム SHALL ユーザにAPI接続エラーが発生した旨を通知し、再試行を促す
3. IF Compass APIがタイムアウトした場合 THEN システム SHALL 適切なタイムアウトメッセージをユーザに表示する
4. WHILE Compass APIからデータを取得中 THE システム SHALL ユーザに処理中であることを示す

### 要件4: カンファレンス情報の構造化された提示
**ユーザストーリー:** エンジニアとして、カンファレンスの詳細情報を見やすい形式で確認したい。それによって、参加するかどうかを素早く判断できる。

#### 受入基準
1. WHEN カンファレンス情報を提示する場合 THEN システム SHALL 以下の情報を含めて表示する：カンファレンス名、開催日時、開催場所（オンライン/オフライン）、概要説明
2. WHEN カンファレンス情報を提示する場合 THEN システム SHALL おすすめ度を分かりやすく表示する
3. WHEN カンファレンス情報を提示する場合 THEN システム SHALL 申込期限を明示し、期限が近いものについてはその旨を強調する
4. WHEN カンファレンス情報を提示する場合 THEN システム SHALL 申込リンク（URL）を提示する
5. IF 申込期限が既に過ぎている場合 THEN システム SHALL 期限切れであることを明示し、参考情報として提示するか除外する
6. WHEN 複数のカンファレンスを提示する場合 THEN システム SHALL おすすめ度順にソートして提示する

### 要件5: チャットインターフェース
**ユーザストーリー:** エンジニアとして、シンプルなチャット画面でエージェントとやりとりしたい。それによって、追加のツール導入なしにカンファレンス情報を取得できる。

#### 受入基準
1. WHEN ユーザがチャット画面にアクセスした場合 THEN システム SHALL ログイン不要でそのまま利用可能な状態とする
2. WHEN ユーザがメッセージを送信した場合 THEN システム SHALL エージェントからの応答をチャット形式で表示する
3. WHILE エージェントが処理中 THE システム SHALL ローディングインジケータを表示する
4. WHEN ユーザが新しいクエリを送信した場合 THEN システム SHALL 会話履歴を画面上に保持し、文脈を維持する

### 要件6: AWS環境でのMVPデプロイメント
**ユーザストーリー:** 開発者として、AWS上でconfeeを稼働させたい。それによって、ユーザにインターネット経由でサービスを提供できる。

#### 受入基準
1. WHEN システムをデプロイする場合 THEN システム SHALL AWS環境上で動作する構成とする
2. WHEN ユーザがURLにアクセスした場合 THEN システム SHALL チャットインターフェースを提供する
3. IF システムに予期しないエラーが発生した場合 THEN システム SHALL エラーログを記録し、ユーザにはフレンドリーなエラーメッセージを表示する
4. WHILE システムが稼働中 THE システム SHALL MVPとして必要最低限のリソースで運用可能とする

### 要件7: おすすめプロンプトの表示
**ユーザストーリー:** エンジニアとして、チャット画面にどのような質問ができるかの例を見たい。それによって、初めて利用する場合でもスムーズにカンファレンス検索を始められる。

#### 受入基準
1. WHEN ユーザがチャット画面に初回アクセスした場合 THEN システム SHALL おすすめのプロンプト例（例：「TypeScriptのカンファレンスある？」「今月開催のLT会を教えて」等）をクリック可能な形式で表示する
2. WHEN ユーザがおすすめプロンプトをクリックした場合 THEN システム SHALL そのプロンプトをクエリとして自動送信し、検索結果を表示する
3. WHEN 会話が開始されメッセージが存在する場合 THEN システム SHALL おすすめプロンプトの表示を非表示にするか、目立たない位置に移動する
4. WHERE おすすめプロンプトを表示する場合 THE システム SHALL 具体的なキーワード検索の例とあいまいな質問の例の両方を含め、利用可能なクエリの幅をユーザに示す

### 要件8: 非機能要件
**ユーザストーリー:** エンジニアとして、ストレスなくエージェントを利用したい。それによって、業務の合間にも素早くカンファレンス情報を確認できる。

#### 受入基準
1. WHEN ユーザがクエリを送信した場合 THEN システム SHALL Compass APIのレスポンスタイムを含め、妥当な時間内（目安：10秒以内）に応答を返す
2. WHILE 複数ユーザが同時にアクセスしている場合 THE システム SHALL MVPとして最低限の同時アクセス（目安：数名程度）を処理できるものとする
3. WHERE Compass APIのAPIキー等の機密情報を扱う場合 THE システム SHALL 環境変数またはシークレットマネージャーを利用し、ソースコードにハードコードしない
